<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr" x-data="marketApp()">
<head>
    <meta charset="UTF-8">
    <title>Marché des Actions</title>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body x-init="init()">
<div class="container py-5">
    <h2 class="text-primary fw-bold mb-4">Cours du marché</h2>

    <div class="table-responsive shadow-sm rounded mb-4">
        <table class="table table-striped table-hover align-middle">
            <thead class="table-dark">
            <tr>
                <th>Symbole</th>
                <th>Nom</th>
                <th>Prix (€)</th>
            </tr>
            </thead>
            <tbody>
            <template x-for="a in actions" :key="a.id">
                <tr>
                    <td x-text="a.symbol"></td>
                    <td x-text="a.nom"></td>
                    <td x-text="a.prix + ' €'"></td>
                </tr>
            </template>
            </tbody>
        </table>
    </div>
</div>

<script>
    function marketApp() {
        return {
            actions: [],
            init() {
                const token = localStorage.getItem('jwt');
                fetch('/api/market/actions', {
                    headers: { "Authorization": "Bearer " + token }
                })
                    .then(res => res.json())
                    .then(data => this.actions = data)
                    .catch(err => console.error("Erreur lors du chargement :", err));
            }
        }
    }
</script>
</body>
</html>
